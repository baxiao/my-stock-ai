import streamlit as st
import re
from datetime import datetime

# 页面配置
st.set_page_config(
    page_title="A股新闻利好利空分析",
    page_icon="🇨🇳",
    layout="centered"
)

st.title("🇨🇳 A股新闻面快速分析")
st.caption("当前日期：" + datetime.now().strftime("%Y年%m月%d日") + " • 专注新闻驱动的利好/利空判断 • 示例：贵州茅台(600519)")

# 输入
ticker_input = st.text_input("输入A股6位代码（例：600519）", value="600519").strip()

if not ticker_input:
    st.info("请输入6位A股代码")
    st.stop()

if not re.match(r'^\d{6}$', ticker_input):
    st.error("请输入正确的6位纯数字A股代码！")
    st.stop()

# 自动补后缀并判断是否支持（目前只示例茅台）
first_digit = ticker_input[0]
if first_digit == '6':
    ticker = ticker_input + ".SS"
elif first_digit in ['0', '3']:
    ticker = ticker_input + ".SZ"
else:
    st.error("暂不支持该前缀的A股（仅示例6开头上证、0/3开头深证）")
    st.stop()

st.success(f"已识别：{ticker_input} → {ticker}")

# ------------------- 核心分析逻辑（目前硬编码贵州茅台2026年1月最新新闻） -------------------
if ticker_input == "600519":
    st.markdown("### 贵州茅台 (600519) • 2026年1月新闻面分析")

    st.subheader("主要利好点（强势主导）")
    st.markdown("""
    - **i茅台平台极度火爆**：1499元/瓶飞天茅台自1月1日上线以来每天“秒空”，多轮补货仍供不应求，短短几天超10万用户抢购，新增用户超270万，成交用户超40万。真实消费需求强劲，品牌消费属性大幅提升。
    - **渠道改革积极推进**：2026年市场化运营方案获通过，回归“金字塔”产品结构（塔基普飞、塔腰精品/生肖、塔尖陈年/文化），构建多元渠道（自售+经销+代售+寄售），动态价格机制。多家券商（财通、东吴、高盛等）认为有助于掌握定价权、扩大群众基础、增厚直销利润。
    - **股价阶段性反弹+回购**：1月5日放量大涨3.54%，市值增超600亿；公司实施回购，机构维持“买入/增持”。
    """)

    st.subheader("主要利空/压力点（短期扰动）")
    st.markdown("""
    - **部分产品出厂价大幅下调**：精品茅台出厂价从2969→1859元/瓶，陈年15年从5399→3409元/瓶，茅台1935打款价从798→668元/瓶。经销商利润承压，渠道调整阵痛明显。
    - **终端批价仍承压**：飞天茅台批发价一度跌破1499元（接近1399-1520元区间），电商低价库存消化压力大。1月13日股价收跌0.86%。
    - **行业整体景气度一般**：高端白酒商务/礼品需求疲软，库存去化缓慢。
    """)

    st.subheader("总体判断 & 操作建议（2026年1月15日视角）")
    st.markdown("""
    **新闻面整体偏利好**（利好强度：8/10）  
    核心逻辑：茅台正从“渠道/金融属性”向“消费属性”转型，主动让利消费者、打击黄牛、扩大直销。i茅台火爆是最大实证，改革阵痛属于短期过渡。

    **短期（1~4周）**：震荡概率大，价格调整阵痛+批价波动可能继续压制股价。  
    **中期（1~3个月）**：方向偏正面，动销企稳后有望筑底反弹。

    **建议**（保守散户视角）：
    - **中长期持有者**：**逢低分批入手或继续持有**（当前位置更像是改革买入机会）
    - **短线/波动敏感者**：**观望为主**，等批价企稳（飞天持续站稳1500元以上）或动销数据进一步改善再考虑
    - **一句话**：转型方向正确，阵痛期往往是机会，但别追涨杀跌。

    **免责声明**：以上纯基于公开新闻整理，非投资建议。股市风险极高，请结合自身情况独立判断。
    """)

else:
    st.warning("目前仅支持贵州茅台(600519)的新闻分析示例。如需扩展其他股票，请提供具体代码，我可以帮你调整逻辑。")

st.markdown("---")
st.caption("数据来源于公开财经新闻（截至2026年1月15日），程序不接入实时API，仅供参考。")